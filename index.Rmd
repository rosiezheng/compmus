---
title: "Borderless"
author: "Rosie Zheng"
date: "20-2-2021"
output: 
  flexdashboard::flex_dashboard:
  storyboard: true
  theme: flatly
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(spotifyr)
library(tidyverse)
library(dplyr)
library(hrbrthemes)
library(viridis)
library(ggplot2)
library(flexdashboard)
library(plotly)
library(compmus)
```

### Introduction

Spotify is the gate to many music genres of all time around the whole world. When we click on “Browse”, there is a tab called “Genres and Moods”, including playlists for the genres Pop, Hip-Hop, Dance/Electronic, Indie, Rock, Soul, R&B, Latin, Country, Folk, Jazz, Blues, Metal, Classical, K-pop, Funk, and Punk. The playlist that cannot be found in any of these genres is “Borderless” and has the following description: “Beyond genre, beyond language, beyond borders”. However, it is not clear what musical components makes this playlist so-called borderless. Are the 98 songs in this playlist really that different from our common-known genres and why exactly? Has the time come to produce “borderless” music?

In this project, we will compare the Borderless playlist with playlists from the five most popular genres nowadays on Spotify: Pop, Hip Hop, Dance/Electronic, Indie, and Rock. The playlists are selected based on highest follower number for that genre. This lead to the following selection: Today's Top Hits (Pop), RapCaviar (Hip-Hop), Dance Party (Dance/Electronic), Ultimate Indie (Indie), and Rock Classics (Rock). We expect that the musical components which belong to a specific genre will not be recognised in the Borderless playlist.

Regarding that the selection of the playlists is only based on number of followers, a limitation could be that the chosen playlists do not fully represent the whole genres, but only the opinion of the big public. However, each playlist will have at least one classic song for that genre included. We can dedicate some detailed analysis on these song and compare them to the songs from the Borderless playlist.


```{r}
borderless <- get_playlist_audio_features("", "37i9dQZF1DWZJmo7mlltU6")
pop <- get_playlist_audio_features("", "37i9dQZF1DXcBWIGoYBM5M")
hiphop <- get_playlist_audio_features("", "37i9dQZF1DX0XUsuxWHRQd")
dance <- get_playlist_audio_features("", "37i9dQZF1DXaXB8fQg7xif")
rock <- get_playlist_audio_features("", "37i9dQZF1DWXRqgorJj26U")
indie <- get_playlist_audio_features("", "37i9dQZF1DX2Nc3B70tvx0")
```

```{r}
playlists_portfolio <-
  bind_rows(
    borderless %>% mutate(category = "Borderless"),
    pop %>% mutate(category = "Pop"),
    hiphop %>% mutate(category = "Hip-Hop"),
    dance %>% mutate(category = "Dance/Electronic"),
    rock %>% mutate(category = "Rock"),
    indie %>% mutate(category = "Indie")
  )
```

### Placement of Borderless songs on the happy scale (energy + valence) in comparison to the other genres

```{r}
happiness <- playlists_portfolio %>%                   
  mutate(
    mode = ifelse(mode == 0, "Minor", "Major")
  ) %>%
  ggplot(                    
    aes(
      x = valence,
      y = energy,
      size = loudness,
      color = mode
    )
  ) +
  geom_point(alpha=0.7) + 
  geom_rug(size = 0.1) +     
  geom_text(                 
    aes(
      x = valence,
      y = energy,
      label = label
    ),
    data = 
      tibble(
        label = c("i'll find my way to you tomorrow", "Lonely (with benny blanco)", "	
Walk On the Wild Side", "Frequency", "Pressure (feat. Tove Lo)", "Moonwalking in Calabasas (feat. Blueface) - Remix"),
        category = c("Borderless", "Pop", "Rock", "Indie", "Dance/Electronic", "Hip-Hop"),
        valence = c(0.6610, 0.0927, 0.385, 0.2140, 0.3570, 0.7450),
        energy = c(0.294, 0.239, 0.318, 0.200, 0.558, 0.341)
      ),
    colour = "black",        
    size = 2,                 
    hjust = "left",          
    vjust = "bottom",         
    nudge_x = -0.05,          
    nudge_y = 0.02            
  ) +
  facet_wrap(~category) +   
  scale_x_continuous(         
    limits = c(0, 1),
    breaks = c(0, 0.25, 0.5,0.75, 1), 
    minor_breaks = NULL       
  ) +
  scale_y_continuous(         
    limits = c(0, 1),
    breaks = c(0, 0.25, 0.5, 0.75, 1),
    minor_breaks = NULL
  ) +
  scale_colour_brewer(     
    type = "qual",            
    palette = "Pastel2"       
  ) +
  scale_size_continuous(     
    trans = "exp",           
    guide = "none"         
  ) +
  theme_light() +             
  labs(                      
    x = "Valence",
    y = "Energy",
    colour = "Mode"
  )

ggplotly(happiness)
```

***

Regarding these graphs, the Borderless playlist is widely distributed over valence and has energy levels of 0.25 and up. It seems that the higher the energy and valence, the louder the music. There are slighly more songs with major modalities than with minor ones. When comparing the Borderless playlist with the other genres, we observe that energy levels are similar to Hip-Hop, Pop, and Indie, valence levels are similar to Rock, loudness levels are similar to Pop and Hip-Hop, and mode is similar to Pop. 


```{r}
# Sample size
sample_size_portfolio = playlists_portfolio %>% group_by(playlist_name) %>% summarize(num=n())
```

### Tempo of Borderless songs in comparison to the other genres

```{r}
# Plot
playlists_portfolio %>%
  left_join(sample_size_portfolio) %>%
  mutate(myaxis = paste0(playlist_name, "\n", "n=", num)) %>%
  ggplot( aes(x=myaxis, y=tempo, fill=playlist_name)) +
    geom_violin(width=1, alpha=0.5) +
    geom_boxplot(width=0.1, color="grey", alpha=0.8) +
    scale_fill_viridis(discrete=TRUE, guide=FALSE, option="A") +
    theme_ipsum() +
    theme(
      legend.position="none",
      plot.title = element_text(size=15)
    ) +
    ggtitle("Tempo") +
    xlab("Playlist") +
  ylab("BPM")

```

***

The mean tempo for the Borderless playlist lays around 120 BPM. This mean comes closest to the Indie playlist and is mostly different from the Dance playlist. Furthermore, we observe that the distribution for tempo is wide-spread for the Borderless playlist and is similar to the distributions of the Rock, Pop, and Indie playlist. 

### Energy of Borderless songs in comparison to the other genres

```{r}
# Plot
playlists_portfolio %>%
  left_join(sample_size_portfolio) %>%
  mutate(myaxis = paste0(playlist_name, "\n", "n=", num)) %>%
  ggplot( aes(x=myaxis, y=energy, fill=playlist_name)) +
    geom_violin(width=1, alpha=0.5) +
    geom_boxplot(width=0.1, color="grey", alpha=0.8) +
    scale_fill_viridis(discrete=TRUE, guide=FALSE, option="A") +
    theme_ipsum() +
    theme(
      legend.position="none",
      plot.title = element_text(size=15)
    ) +
    ggtitle("Energy") +
    xlab("Playlist") +
  ylab("Energy Level")

```

***

In the first graph, we observed that energy levels for Borderless were similar to Hip-Hop, Pop, and Indie. Here we can observe that the violin shape is mostly the samefor Pop and indie. Rap, however, shares the same boxplot.

### Loudness of Borderless songs in comparison to the other genres

```{r}
# Plot
playlists_portfolio %>%
  left_join(sample_size_portfolio) %>%
  mutate(myaxis = paste0(playlist_name, "\n", "n=", num)) %>%
  ggplot( aes(x=myaxis, y=loudness, fill=playlist_name)) +
    geom_violin(width=1, alpha=0.5) +
    geom_boxplot(width=0.1, color="grey", alpha=0.8) +
    scale_fill_viridis(discrete=TRUE, guide=FALSE, option="A") +
    theme_ipsum() +
    theme(
      legend.position="none",
      plot.title = element_text(size=15)
    ) +
    ggtitle("Loudness") +
    xlab("Playlist") +
  ylab("dB")

```
### Danceability of Borderless songs in comparison to the other genres

```{r}
# Plot
playlists_portfolio %>%
  left_join(sample_size_portfolio) %>%
  mutate(myaxis = paste0(playlist_name, "\n", "n=", num)) %>%
  ggplot( aes(x=myaxis, y=danceability, fill=playlist_name)) +
    geom_violin(width=1, alpha=0.5) +
    geom_boxplot(width=0.1, color="grey", alpha=0.8) +
    scale_fill_viridis(discrete=TRUE, guide=FALSE, option="A") +
    theme_ipsum() +
    theme(
      legend.position="none",
      plot.title = element_text(size=15)
    ) +
    ggtitle("Danceability") +
    xlab("Playlist") +
  ylab("Danceability Level")

```

***

Danceability for Borderless is mostly similar to Indie. 

### Speechiness of Borderless songs in comparison to the other genres

```{r}
# Plot
playlists_portfolio %>%
  left_join(sample_size_portfolio) %>%
  mutate(myaxis = paste0(playlist_name, "\n", "n=", num)) %>%
  ggplot( aes(x=myaxis, y=speechiness, fill=playlist_name)) +
    geom_violin(width=1, alpha=0.5) +
    geom_boxplot(width=0.1, color="grey", alpha=0.8) +
    scale_fill_viridis(discrete=TRUE, guide=FALSE, option="A") +
    theme_ipsum() +
    theme(
      legend.position="none",
      plot.title = element_text(size=15)
    ) +
    ggtitle("Speechiness") +
    xlab("Playlist") +
  ylab("Speechiness Level")

```

***

Speechiness is low for every genre except Hip-Hop which is logical. Borderless comes closest to Rock and Indie. 

### Acousticness of Borderless songs in comparison to the other genres

```{r}
# Plot
playlists_portfolio %>%
  left_join(sample_size_portfolio) %>%
  mutate(myaxis = paste0(playlist_name, "\n", "n=", num)) %>%
  ggplot( aes(x=myaxis, y=acousticness, fill=playlist_name)) +
    geom_violin(width=1, alpha=0.5) +
    geom_boxplot(width=0.1, color="grey", alpha=0.8) +
    scale_fill_viridis(discrete=TRUE, guide=FALSE, option="A") +
    theme_ipsum() +
    theme(
      legend.position="none",
      plot.title = element_text(size=15)
    ) +
    ggtitle("Acousticness") +
    xlab("Playlist") +
  ylab("Acousticness Level")

```

***

The distribution for acousticness is almost the same for Rock. It is completely different from Dance.

### Instrumentalness of Borderless songs in comparison to the other genres

```{r}
# Plot
playlists_portfolio %>%
  left_join(sample_size_portfolio) %>%
  mutate(myaxis = paste0(playlist_name, "\n", "n=", num)) %>%
  ggplot( aes(x=myaxis, y=instrumentalness, fill=playlist_name)) +
    geom_violin(width=1, alpha=0.5) +
    geom_boxplot(width=0.1, color="grey", alpha=0.8) +
    scale_fill_viridis(discrete=TRUE, guide=FALSE, option="A") +
    theme_ipsum() +
    theme(
      legend.position="none",
      plot.title = element_text(size=15)
    ) +
    ggtitle("Instrumentalness") +
    xlab("Playlist") +
  ylab("Instrunemntalness Level")

```

***

It seems that instrumentalness cannot be visualized very well with a violin plot. 

### Liveness of Borderless songs in comparison to the other genres

```{r}
# Plot
playlists_portfolio %>%
  left_join(sample_size_portfolio) %>%
  mutate(myaxis = paste0(playlist_name, "\n", "n=", num)) %>%
  ggplot( aes(x=myaxis, y=liveness, fill=playlist_name)) +
    geom_violin(width=1, alpha=0.5) +
    geom_boxplot(width=0.1, color="grey", alpha=0.8) +
    scale_fill_viridis(discrete=TRUE, guide=FALSE, option="A") +
    theme_ipsum() +
    theme(
      legend.position="none",
      plot.title = element_text(size=15)
    ) +
    ggtitle("Liveness") +
    xlab("Playlist") +
  ylab("Liveness Level")

```

***

The distribution for liveness is mostly similar to Indie but is more smeared out for higher values for Borderless. 

### Valence of Borderless songs in comparison to the other genres

```{r}
# Plot
playlists_portfolio %>%
  left_join(sample_size_portfolio) %>%
  mutate(myaxis = paste0(playlist_name, "\n", "n=", num)) %>%
  ggplot( aes(x=myaxis, y=valence, fill=playlist_name)) +
    geom_violin(width=1, alpha=0.5) +
    geom_boxplot(width=0.1, color="grey", alpha=0.8) +
    scale_fill_viridis(discrete=TRUE, guide=FALSE, option="A") +
    theme_ipsum() +
    theme(
      legend.position="none",
      plot.title = element_text(size=15)
    ) +
    ggtitle("Valence") +
    xlab("Playlist") +
  ylab("Valence Level")
```

***

Valence would be most similar to Rock. However, there seem to be more lower valences in the Borderless playlist than in the Rock playlist.
